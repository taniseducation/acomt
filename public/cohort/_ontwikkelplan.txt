notes:
cohorten cid 181 t/m 273 hebben beginjaar 2021
181 is mavo: die werkt wel? Of ook niet.
select * from cohortjaar where cid >= 181 and cid <=183
probleem: mavo is goed want hij telt 2021 2022 maar voor havo niet gereset dus telt door van 2022 naar 2023 
en vwo van 2023 via 2024 naar 2025
=> schrijf script om dit per vak te repareren
=> daarna verder met kopieer_cohorten, want die loopt hier terecht op vast (leve de checks!)

# ISSUES
- cohorten 2021 hebben blijkbaar niet altijd een cohortjaar gekregen. NL cid 182 havo 2021
- maak laatste export / import master voor genereren excel zonder kopie
- kopieer cohortjaar van huidige zodat ze niet over hoeven te typen.
- als voorw.opm. niet lukt: Als er iets rood is: kengetal in settings veranderen, zodat de inlees wordt geblokeerd. Kan met extra veld en check die al in voorwaardelijke opmaak zit ingebouwd
- bij inlezen ook check op correctheid records => tenzij dit al met ROOD wordt gefilterd. Ik zou het toch inbouwen.

- apart tabblad voor toetsweek dat in tweede instantie wordt gegenereerd: DAN de CODE veranderen zodat hij alleen roostermaker inleest!

UITGESTELD
- zowel validatie als opmaak is niet goed te clonen. Voorwaardelijke opmaak lijkt al lost bij openen
    https://phpspreadsheet.readthedocs.io/en/latest/topics/recipes/#conditional-formatting-a-cell
    kun je ook gebruik om te laden, maar specifieke cel zie ik niet.

AFGEHANDELD
- check op oud bestand gewoon inbouwen, door alleen inlezen bestanden met toevoeging 2021?
    Nee, dan passen ze bestandsnaam aan. moet ergens in veld staan. Dat is dus de Ster * in G1
- mededeling verouderde file. Moet dat dan niet in Sjabloon? Of iets met wegschrijven invoerjaar?
    Kun je elk jaar aan de tabbladen zien => nieuw jaar = nieuw cohort

_______________________________________
# LEZEN VAN RIJ OF MEER VOOR WEGSCHRIJVEN (kun je for each doen voor elke rij?)
$dataArray = $spreadsheet->getActiveSheet()
    ->rangeToArray(
        'C3:E5',     // The worksheet range that we want to retrieve
        NULL,        // Value that should be returned for empty cells
        TRUE,        // Should formulas be calculated (the equivalent of getCalculatedValue() for each cell)
        TRUE,        // Should values be formatted (the equivalent of getFormattedValue() for each cell)
        TRUE         // Should the array be indexed by cell row and cell column
    );

_______________________________________
# KOPIEREN EN VERWIJDEREN WORKSHEETS gebruik sjabloon en gooi die aan het eind weg?
// https://phpspreadsheet.readthedocs.io/en/latest/topics/worksheets/

$clonedWorksheet = clone $spreadsheet->getSheetByName('Worksheet 1');
$clonedWorksheet->setTitle('Copy of Worksheet 1');
$spreadsheet->addSheet($clonedWorksheet);

$sheetIndex = $spreadsheet->getIndex(
    $spreadsheet->getSheetByName('Worksheet 1')
);
$spreadsheet->removeSheetByIndex($sheetIndex);

_______________________________________
# ALLEEN EEN RIJ voor cohortItem
$rowArray = ['Value1', 'Value2', 'Value3', 'Value4'];
$spreadsheet->getActiveSheet()
    ->fromArray(
        $rowArray,   // The data to set
        NULL,        // Array values with this value will not be set
        'C3'         // Top left coordinate of the worksheet range where
                     //    we want to set these values (default is A1)
    );
_______________________________________
# RIJ EN KOLOM
$arrayData = [
    [NULL, 2010, 2011, 2012],
    ['Q1',   12,   15,   21],
    ['Q2',   56,   73,   86],
    ['Q3',   52,   61,   69],
    ['Q4',   30,   32,    0],
];
$spreadsheet->getActiveSheet()
    ->fromArray(
        $arrayData,  // The data to set
        NULL,        // Array values with this value will not be set
        'C3'         // Top left coordinate of the worksheet range where
                     //    we want to set these values (default is A1)
    );
_______________________________________
# ALS JE RIJ NAAR KOLOM WILT ZETTEN

$rowArray = ['Value1', 'Value2', 'Value3', 'Value4'];
$columnArray = array_chunk($rowArray, 1);
$spreadsheet->getActiveSheet()
    ->fromArray(
        $columnArray,   // The data to set
        NULL,           // Array values with this value will not be set
        'C3'            // Top left coordinate of the worksheet range where
                        //    we want to set these values (default is A1)
    );

_______________________________________

$spreadsheet->getActiveSheet()->setCellValue(
    'A4',
    '=IF(A3, CONCATENATE(A1, " ", A2), CONCATENATE(A2, " ", A1))'
);
_______________________________________

$cellValue = $spreadsheet->getActiveSheet()->getCell('A4')->getCalculatedValue();

_______________________________________


_______________________________________


_______________________________________


_______________________________________

V database structuur ITEMS onderwijsprogramma moet nog => breder trekken naar PTB en PTO?
V inladen vakken
V? inlezen bestaand PTA MET toevoeging PTA code SOM en cohort vanuit masterfile
V ontwerp nieuw Excel-invoer met cohorten V sjabloon schrijft weg naar nieuwe file
V writer maken die dit genereert vanuit database me toevoeging cohortcodes
reader maken die alleen nieuwe cohorten invoert maar wel waarschuwt dat iets ouds overschreven is.
PDF generator op basis van database met id's.
Genereer op definitief goedgekeurde PTA's een aparte toetsweekinventarisatie-tool (Waarbij je de rest locked?)

KEUZES
Somcode niet bij inlezen maar genereren bij wegschrijven als je weet hoeveel records er zijn

? Voeg meteen vid toe aan PTA-items voor eenvoudiger zoeken in de toekomst.
? cid 111 met moderne wiskunde e.d. heeft twee items die leeg zijn met periode 0. Hoe dan?
Check rare items door sorteren database

