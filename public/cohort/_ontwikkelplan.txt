# ISSUES
- WTF mijn hele schrijfrecht die al prima werkte is naar de FUCK
    check of sjabloon wel op lock staat
    anders: daarna heb je gewerkt aan weggooien onnodige tabbladen
- H6 NU GEDAAN bij elk cohort moeten vorige jaren zonder schrijfrecht
    set security https://phpspreadsheet.readthedocs.io/en/latest/topics/recipes/#conditional-formatting-a-cell
- bij mavo en havo moeten niet relevante jaren verwijderd NEE VERBERGEN IS BETER
- check hoe zit het met blokkade van gegenereerde tabbladen?
- Kun je statische array maken met per vak de tabbladen die weggegooid kunnen worden?
    b.v. IF geen vmbo WAT ZIJN CONSEQUENTIES VOOR INLEZEN!?
- weggooien sjabloon-sheet?
- sjabloon moet nog weer aangepast: systeemkolommen nu zichtbaar
    hoeft niet meer want hide in code ingevoegd
- kopieer cohortjaar van huidige zodat ze niet over hoeven te typen.

- check op oud bestand gewoon inbouwen, door alleen inlezen bestanden met toevoeging 2021?
Nee, dan passen ze bestandsnaam aan. moet ergens in veld staan.
- https://www.php.net/manual/en/function.addslashes en strip gebruiken voor strings met ' etc. WOOT's

- check apart kunstvak MAVO met als enige 3e klas: hoe ziet het er uit?
- Da's KUT: vermelden dus. Wat gebeurt er als je knipt en plakt van ander tabblad? Hoe zit het met opmaakvoorwaarden, beschikbaarheid dropdown e.d.?
- kun je voorwaardelijke opmaak van sjabloon kopieren en die daarna weggooien? Anders veel werk verloren
- als voorw.opm. niet lukt: Als er iets rood is: kengetal in settings veranderen, zodat de inlees wordt geblokeerd. Kan met extra veld en check die al in voorwaardelijke opmaak zit ingebouwd
- voorblad met instructie: ga niet dingen formatten: dat doen wij => Dat is dan ook Active sheet???!!! Niet knoppen.
- bij inlezen ook check op correctheid records => tenzij dit al met ROOD wordt gefilterd. Ik zou het toch inbouwen.

- voorkomen dat oude versies geupload worden? Check op id's voordat er wordt weggeschreven maar dan ook time()?
- mededeling verouderde file. Moet dat dan niet in Sjabloon? Of iets met wegschrijven invoerjaar?
- apart tabblad voor toetsweek dat in tweede instantie wordt gegenereerd: DAN de CODE veranderen zodat hij alleen roostermaker inleest!

UITGESTELD
- check op WOOT's bij terugschrijven naar Excel. addslashes zit in maak_items
    Zit in opmerking afname en dus eerst nog niet in gebruikt
- zowel validatie als opmaak is niet goed te clonen. Voorwaardelijke opmaak lijkt al lost bij openen
    https://phpspreadsheet.readthedocs.io/en/latest/topics/recipes/#conditional-formatting-a-cell
    kun je ook gebruik om te laden, maar specifieke cel zie ik niet.

_______________________________________
# LEZEN VAN RIJ OF MEER VOOR WEGSCHRIJVEN (kun je for each doen voor elke rij?)
$dataArray = $spreadsheet->getActiveSheet()
    ->rangeToArray(
        'C3:E5',     // The worksheet range that we want to retrieve
        NULL,        // Value that should be returned for empty cells
        TRUE,        // Should formulas be calculated (the equivalent of getCalculatedValue() for each cell)
        TRUE,        // Should values be formatted (the equivalent of getFormattedValue() for each cell)
        TRUE         // Should the array be indexed by cell row and cell column
    );

_______________________________________
# KOPIEREN EN VERWIJDEREN WORKSHEETS gebruik sjabloon en gooi die aan het eind weg?
// https://phpspreadsheet.readthedocs.io/en/latest/topics/worksheets/

$clonedWorksheet = clone $spreadsheet->getSheetByName('Worksheet 1');
$clonedWorksheet->setTitle('Copy of Worksheet 1');
$spreadsheet->addSheet($clonedWorksheet);

$sheetIndex = $spreadsheet->getIndex(
    $spreadsheet->getSheetByName('Worksheet 1')
);
$spreadsheet->removeSheetByIndex($sheetIndex);

_______________________________________
# ALLEEN EEN RIJ voor cohortItem
$rowArray = ['Value1', 'Value2', 'Value3', 'Value4'];
$spreadsheet->getActiveSheet()
    ->fromArray(
        $rowArray,   // The data to set
        NULL,        // Array values with this value will not be set
        'C3'         // Top left coordinate of the worksheet range where
                     //    we want to set these values (default is A1)
    );
_______________________________________
# RIJ EN KOLOM
$arrayData = [
    [NULL, 2010, 2011, 2012],
    ['Q1',   12,   15,   21],
    ['Q2',   56,   73,   86],
    ['Q3',   52,   61,   69],
    ['Q4',   30,   32,    0],
];
$spreadsheet->getActiveSheet()
    ->fromArray(
        $arrayData,  // The data to set
        NULL,        // Array values with this value will not be set
        'C3'         // Top left coordinate of the worksheet range where
                     //    we want to set these values (default is A1)
    );
_______________________________________
# ALS JE RIJ NAAR KOLOM WILT ZETTEN

$rowArray = ['Value1', 'Value2', 'Value3', 'Value4'];
$columnArray = array_chunk($rowArray, 1);
$spreadsheet->getActiveSheet()
    ->fromArray(
        $columnArray,   // The data to set
        NULL,           // Array values with this value will not be set
        'C3'            // Top left coordinate of the worksheet range where
                        //    we want to set these values (default is A1)
    );

_______________________________________

$spreadsheet->getActiveSheet()->setCellValue(
    'A4',
    '=IF(A3, CONCATENATE(A1, " ", A2), CONCATENATE(A2, " ", A1))'
);
_______________________________________

$cellValue = $spreadsheet->getActiveSheet()->getCell('A4')->getCalculatedValue();

_______________________________________


_______________________________________


_______________________________________


_______________________________________

V database structuur ITEMS onderwijsprogramma moet nog => breder trekken naar PTB en PTO?
V inladen vakken
V? inlezen bestaand PTA MET toevoeging PTA code SOM en cohort vanuit masterfile
V ontwerp nieuw Excel-invoer met cohorten V sjabloon schrijft weg naar nieuwe file
V writer maken die dit genereert vanuit database me toevoeging cohortcodes
reader maken die alleen nieuwe cohorten invoert maar wel waarschuwt dat iets ouds overschreven is.
PDF generator op basis van database met id's.
Genereer op definitief goedgekeurde PTA's een aparte toetsweekinventarisatie-tool (Waarbij je de rest locked?)

KEUZES
Somcode niet bij inlezen maar genereren bij wegschrijven als je weet hoeveel records er zijn

? Voeg meteen vid toe aan PTA-items voor eenvoudiger zoeken in de toekomst.
? cid 111 met moderne wiskunde e.d. heeft twee items die leeg zijn met periode 0. Hoe dan?
Check rare items door sorteren database

